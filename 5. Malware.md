-  Any software that is designed to infiltrate a computer system without the user's knowledge (Malicious + Software).
- For the malware to infect your system, it needs to be able to create a threat vector and attack vector:
	- Threat Vector: specific method used by an attacker to infiltrate a victim's machine
	- Attack Vector: A means by which an attacker gain access to a computer to infect the system with malware

```
Threat Vector: breaks into the system
a path or method an attacker uses to target a victim and start the attack, its how the hacker reaches the victim.
example: imagine you get an email that looks like its from your bank, in this email, there’s a link asking you to "verify your account", this "phishing email" is the threat vector — its the method or way the attacker reaches you.

Attack Vector: breaks into and infects the system
a is the actual means by which the attacker delivers the malware or gets access to the victim’s system, its how the attacker enters the victim's computer or network.
example: when you click the link in the phishing email, it takes you to a fake website that looks just like your bank’s site, but when you log in, it secretly collects your login info, the "fake website" is the attack vector — its the means the hacker uses to get your personal information.
```
### Types of Malware
#### Computer Virus
Malicious code that is run on a machine without the user's knowledge and this allows the code to infect the computer whenever it has been run.
There are multiple types of Virus:
1. Boot Sector  
2. Macro  
3. Program  
4. Multipartite  
5. Encrypted  
6. Polymorphic  
7. Metamorphic  
8. Stealth  
9. Armor  
10. Hoax

Explanations:
1. Boot sector:
   Boot sector virus infect a disk’s boot sector or master boot record so they execute before the operating system loads, often spreading via removable media like USB drives. These viruses can be hard to remove because they gain control very early in the boot process and may corrupt system startup code.

2. Macro:
   Macro virus target documents or spreadsheets that support macros (such as Word or Excel files) by embedding malicious macro code inside them. When the user opens or enables macros in an infected document, the virus runs and can modify files, send emails, or drop additional payloads.
   
3. Program (file):
   Program virus attach themselves to executable files such as `.exe` or `.dll`, inserting their code into legitimate programs. When the infected program is launched, the virus activates, can infect other executables, and may damage or alter data and applications.

4. Multipartite:
   Multipartite viruses infect multiple parts of a system simultaneously, typically both the boot sector and executable files. This dual infection makes them more persistent and difficult to clean, because removing one component may still leave another active infection source.

5. Encrypted:
   Encrypted viruses keep their main body in encrypted form to avoid static signature detection by antivirus engines. They include a small decryption routine that runs first, decrypts the payload in memory, and then executes the malicious code.
   
6. Polymorphic:
   Polymorphic viruses change their code pattern or encryption each time they infect a new file or system, while keeping the same malicious behavior. By constantly mutating their appearance, they evade traditional signature-based detection and require more advanced heuristic or behavioral analysis to detect.

7. Metamorphic:
   Metamorphic viruses go a step further than polymorphic ones by actually rewriting or reordering their own code on each generation without using simple encryption. The virus logic stays functionally the same, but the internal structure changes drastically, making static analysis and signature creation very challenging.

8. Stealth:
   Stealth viruses use techniques such as intercepting system calls or modifying APIs to hide their presence from security tools and the operating system. They may falsify file sizes, checksum results, or disk read operations so that scanners see only clean data while the infected code remains concealed.

9. Armor (armored):
   Armor viruses incorporate defenses designed to hinder analysis and reverse engineering, such as obfuscated code, anti-debugging checks, or virtualization detection. These protections make it harder for analysts and automated tools to understand, emulate, or dissect the malware’s behavior.

10. Hoax:
    virus are not real malware, but a false warnings or messages that claim a dangerous new virus exists and urge users to take unnecessary or harmful actions. Such hoaxes can waste resources, cause users to delete important files, and spread misinformation through email, social media, or messaging platforms.
#### Worm
- Piece of malicious software, much like a virus, but it can replicate itself without any user interaction.
- Worm are dangerous because of:
	- can infect the workstation and other computing assets.
	- can cause disruptions to the normal network traffic since they are constantly trying to replicate and spread across the network.
- Worms are best known for spreading far and wide over the internet in a relatively short amount of time.
Example:
- The Nimda worm spread in just 22 minutes by exploiting multiple methods, including email attachments, network shares, and vulnerabilities in Microsoft IIS servers. It caused widespread disruption, infecting both personal and corporate systems globally.
- The Conficker worm infected 9 to 15 million systems by exploiting a Windows vulnerability (MS08-067). It spread rapidly via network shares and USB drives, creating a massive botnet and evading detection by disabling security measures.

```
- virus needs human action to spread (e.g., opening files)
- worm: self-replicates and spreads automatically across networks without any human interaction
```
#### Trojan
A piece of malicious software that is disguised as a piece of harmless or desirable software.
Example:
Emotet Trojan: Originally designed as a banking Trojan, Emotet would disguise itself as a legitimate email attachment (often in a Word or PDF file). Once opened, it would install malware on the victim’s system, allowing hackers to steal banking credentials, install ransomware, or spread further infections within the network.
##### Remote Access Trojan (RAT):
Type of Trojan that is widely used by modern attackers because it provides the attacker with remote control of a victim machine.
#### Ransomware
Type of malicious software that is designed to block access to a computer system or its data by encrypting it until a ransom is paid to the attacker.
Example:
The Colonial Pipeline ransomware attack took place in May 2021, and it became one of the most significant cybersecurity incidents in recent history, affecting the U.S. fuel supply and leading to widespread disruptions.

How to protect against Ransomware:
- conducting regular backups
- installing regular software updates
- providing security awareness training
- implementing MFA for the systems

If you're affected by a ransomware attack:
- do not pay the ransom as it encourages further attacks
- Isolate the infected system from the network to prevent spread
- Inform authorities like law enforcement or cybercrime units to help with the investigation
- Finally, restore from known good backups to recover your files without engaging with the attackers
#### Botnet and Zombie 
##### Botnet
Network of compromised computers or devices controlled remotely by malicious actors
##### Zombie
Name of a compromised computer or device that is part of a botnet and used to perform tasks using remote commands

Use of Botnet:
- use as part of spam or phishing campaign
- DDoS
- Crypto-mining
- Encryption cracking
#### Rootkit
- Type of software that is designed to gain administrative-level control over a given computer system without being detected.
- Rootkit are designed to dig deep into the operating system that make it hard for antivirus to detect it.

Techniques used by rootkits to manipulate and control a system:
- DLL injection: Involves inserting a malicious Dynamic Link Library (DLL) into a running process's memory. This allows the attacker to control or monitor the process by manipulating its functions, often without the user’s knowledge. A malware program injects a DLL into a legitimate process like **explorer.exe**, allowing the attacker to monitor system activity and execute commands silently.
- Shim Attack: A **shim** is a small piece of code that intercepts and modifies function calls between applications and the operating system. A **shim attack** involves creating a malicious shim to hijack the behavior of certain system processes or software. A rootkit might use a shim to intercept system calls and redirect file system operations to a hidden location, making it difficult for antivirus software to detect or remove the rootkit.
#### Backdoor and Logic Bomb
##### Backdoor
A backdoor is a hidden method of bypassing normal authentication or encryption in a system. It allows an attacker to remotely access and control a system without being detected.
##### Logic Bomb
A logic bomb is malicious code that is triggered by a specific event or condition, such as a date or the execution of a particular command. It lies dormant until the trigger activates it.

```
Easter Egg: An easter egg is a hidden feature or message intentionally placed in a program or system by its creators, often for fun or as a secret. It’s not intended to be malicious but can sometimes be exploited if discovered by unauthorized users.
```
#### Keylogger
- Piece of software or hardware that records every single keystroke that is made on a computer or mobile device.
- Keylogger, originally developed by system administrative to help them to troubleshoot technical problem.

How to protect against Keylogger:
- Ensure performing regular updates and patches
- Rely on quality antivirus and anti malware solution
- conduct phishing awareness training for all end users
- implement MFA systems
- Encrypt keystrokes being sent to systems
- Perform physical checks of desktops, laptops and servers
#### Spyware and Bloatware
##### Spyware
Type of malicious software that is designed to gather and send information about a user or organization without consent.
##### Bloatware
- Any software that comes pre-installed on a new computer or smartphone.
- Why Bloatware not good for system:
	- waste storage space
	- slows down the performance of device
	- introduce new security vulnerabilities into system
### How this modern malware works
##### Stage 1
When a user clicks on a malicious link or opens a malicious file, malware is installed.
##### Stage 2
Download and install a remote access Trojan to conduct command and control on victimized system.
##### Stage 3
Action on objective phase such as data exfiltration.
##### Concealment
Clean up all evidences to mislead forensic investigation.

```
living off the land: the threat actors try to exploit the standard system tools to perform intrusions
```
### Indicators of Malware Attack
1. Account lockout:
   Multiple lockouts or a sudden spike in failed logons suggests password‑spray or brute‑force activity, often automated and sometimes malware‑driven (botnets, credential‑stuffing tools).

2. Concurrent session utilization:
   Multiple active sessions for the same account, especially from different devices or geolocation, suggests account compromise or session hijacking rather than normal user behavior.

3. Blocked content:
   Security controls (web filters, email gateways, EDR, firewall) repeatedly blocking known‑malicious domains, URLs, or payloads from the same user or host indicates infection attempts or active C2 communication.

4. Impossible travel:
   Logins or token use from geographically distant locations within a time window that makes physical travel impossible strongly indicates stolen credentials or session abuse.

5. Resource consumption:
   Abnormally high CPU, RAM, disk, or network usage on endpoints/servers without a legitimate workload often maps to crypto-miners, worms, or data exfiltration tools.

6. Resource inaccessibility:
   Legitimate services, shares, or applications suddenly becoming unavailable can reflect ransomware, destructive malware, or DoS conditions.

7. Out‑of‑cycle logging:
   Logs appearing at unusual times (e.g., heavy activity at 3 AM for a 9‑to‑5 environment) can indicate scripted or automated malicious tasks.

8. Missing logs:
   Sudden gaps in security, application, or audit logs may mean log deletion or pipeline tampering, a common anti‑forensics technique used by sophisticated malware and attackers.

9. Published or Documented:
   Attacks refer to malware or cyberattacks that are publicly reported through news outlets, cybersecurity blogs, or advisories. If these attacks target vulnerabilities in widely used systems, organizations should be vigilant, as similar attacks could target them.
 
Next module [[6. Data Protection]]