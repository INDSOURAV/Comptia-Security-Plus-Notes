Vulnerability:
Weaknesses or flaws in hardware, software, configuration, or processes within a computer system, network, or application that could be exploited by malicious entities.
Attack:
Deliberate actions or activities carried out by threat actors with the intent to exploit vulnerabilities such as unauthorized access, data theft, malware infection, DDoS, or social engineering.
### Hardware Vulnerabilities
Security flaws or weaknesses inherent in a device's physical components or design that can be exploited to compromise the integrity, confidentiality, or availability of the system and its data.
There are different hardware vulnerabilities:
1. Device's firmware:
   Firmware is the low-level code that controls hardware functions, and if it is outdated, insecurely written, or tampered with, attackers can gain deep, persistent access to a system. Since firmware often operates below the operating system, malicious modifications can remain hidden for long periods and allow attackers to bypass security controls or reprogram hardware behavior.
   Can mitigate by regular updates, security auditing and device hardening
   
2. End-of-life hardware:
   When a component or device reaches the end of its supported lifecycle, the manufacturer stops releasing security updates or patches. Even if new vulnerabilities are discovered, they remain unaddressed. Organizations that continue using such outdated hardware expose themselves to risks because attackers can exploit known weaknesses that will never be fixed.
   
3. Legacy hardware:
   Legacy hardware is similar, but in this case, the equipment may still function, yet it was built with older technologies that were not designed to withstand modern threats. These devices may lack encryption capabilities, secure boot, or advanced authentication mechanisms. As a result, they cannot defend against current attack techniques, making them easy targets if they remain integrated into modern networks.
   
4. Unsupported systems and applications:
   Unsupported systems and applications also contribute significantly to hardware vulnerabilities. When systems or applications no longer receive vendor support, they stop receiving updates, patches, and compatibility improvements. This creates gaps that attackers can exploit to gain unauthorized access, especially when these unsupported components interact with newer and more secure technologies.

5. Unpatched systems:
   unpatched systems are a common and dangerous vulnerability. Even when updates are available, organizations sometimes delay or ignore patching due to operational concerns, compatibility issues, or lack of maintenance processes. Leaving systems unpatched allows attackers to take advantage of documented flaws that have already been discovered and publicly exposed. In many cases, attackers actively scan networks to identify and exploit unpatched devices.

6. Hardware Misconfiguration:
   Occurs when a device's settings, parameters, or options are not optimally set up, and this can cause vulnerabilities to exist, a decrease in performance, or unintended behavior of devices or systems.
   Can mitigate by conduct regular audits, enforce good configuration management practice, implement automated tools, and provide training to the personnel.

Mitigations:
1. Hardening:
   Hardening involves securing hardware devices by disabling unnecessary ports, services, and interfaces, ensuring only essential functionalities are active. This reduces the attack surface and minimizes opportunities for exploitation.
   
2. Patching:
   Applying firmware and microcode updates ensures known hardware vulnerabilities are fixed promptly. Regular patching helps protect devices from exploits targeting outdated or vulnerable hardware components.
   
3. Configuration Enforcement:
   Enforcing secure configurations ensures that hardware devices operate with consistent, organization-approved security settings. This prevents misconfigurations that could expose hardware to exploitation or unauthorized access.
   
4. Decommissioning:
   End-of-life or unsupported hardware should be safely retired from the environment. Decommissioning reduces risk by removing devices that can no longer receive updates, patches, or vendor support.
   
5. Isolation:
   Critical or vulnerable hardware can be isolated from the main network to limit exposure. Isolation prevents compromised or weak devices from impacting the broader environment.
   
6. Segmentation:
   Network segmentation separates hardware into controlled zones, ensuring vulnerabilities in one device or segment cannot easily spread across the network. It adds a layer of protection by limiting lateral movement opportunities.
### Bluetooth Vulnerabilities and Attacks
Wireless technology standard used for exchanging data between fixed and mobile devices over short distances without the need for an internet connection.
Vulnerabilities with Bluetooth:
- Insecure Device Pairing:
  Occurs when Bluetooth devices establish a connection without proper authentication, this occurs because some Bluetooth devices do not require any authentication at all or using weaker authentication methods.
- Device Spoofing:
  Occurs when an attacker impersonates a device to trick a user into connecting.
- On-Path Attack:
  Exploits Bluetooth protocol vulnerabilities to intercept and alter communications between devices without either party being aware.
##### Bluetooth Attacks:
1. Bluejacking:
   Bluejacking involves sending unsolicited messages or business cards to nearby Bluetooth-enabled devices. It is generally harmless but can be used to annoy or distract users.
   
2. Bluesnarfing:
   Bluesnarfing is an attack where an attacker exploits Bluetooth vulnerabilities to access a device’s data without permission, such as contacts, messages, emails, or files. It is a serious privacy and security threat.
   
3. Bluebugging:
   Bluebugging allows an attacker to gain full control over a victim’s Bluetooth device. Once exploited, the attacker can make calls, send messages, access data, or even listen to conversations without the user’s knowledge.
   
4. Bluesmack:
   Bluesmack is a Bluetooth-based Denial-of-Service (DoS) attack that overwhelms a device by sending large ping packets. This can slow down or crash the victim’s Bluetooth functionality.
   
5. Blueborne:
   Blueborne is a severe attack vector that allows remote code execution on devices via Bluetooth, even without pairing. It exploits protocol-level vulnerabilities, enabling attackers to take control, spread malware, or access data over the air.  
##### Best practices to prevent these attacks:
- Turning off Bluetooth
- Ensuring that devices are set to "non-discoverable" mode
- Regularly updating devices
- Only pairing with known and trusted devices
- Always using unique PINs or passkeys
- Always being cautions of unsolicited connection requests
- Using encryption for sensitive data transfer
### Mobile Vulnerabilities and Attacks
1. Sideloading:
   Sideloading is the process of installing applications from unofficial or third-party sources instead of the device’s official app store. While it allows access to apps not available in the store, it bypasses built-in security checks, increasing the risk of installing malicious, tampered, or unverified applications that can compromise the device.
   
2. Jailbreaking and Rooting:
   Jailbreaking (iOS) and rooting (Android) involve removing the manufacturer’s security restrictions to gain full administrative control over a mobile device. While it allows deeper customization, it also disables built-in security protections, making the device more vulnerable to malware, unauthorized access, and system tampering.
   
3. Insecure connection methods:
   Using unsecured or untrusted network connections—such as public Wi-Fi, open Bluetooth, or weak mobile hotspot configurations—exposes mobile devices to eavesdropping, man-in-the-middle attacks, and data interception. Attackers can exploit these weak connections to steal credentials, inject malicious traffic, or compromise the device.

Mobile Device Management (MDM) Solution
Used to conduct patching of the devices by pushing any necessary updates to the devices to ensure that they are always equipped with latest security patches.
- Disable a device's ability to sideload programs
- Detect if a device has been jailbroken or rooted
- Force each device to use a VPN connection
### Zero-Day Vulnerabilities
A zero-day vulnerability is a security flaw that is unknown to the software or hardware vendor and therefore has no official patch or fix available. Since defenders are unaware of the issue, attackers can exploit it immediately, making it highly dangerous.
##### Zero-Day Exploit
A zero-day exploit is the actual attack or method used to take advantage of a zero-day vulnerability. It is launched before the vendor becomes aware of the flaw or can release a patch, allowing attackers to compromise systems with little to no resistance.
### Operating System Vulnerabilities
1. Unpatched Systems:
   When an operating system is not updated with the latest security patches, it remains exposed to known vulnerabilities. Attackers can easily exploit these unpatched flaws to gain access, escalate privileges, or compromise system functionality.
   
2. Zero-day Vulnerabilities:
   These are previously unknown flaws within an operating system that attackers discover and exploit before the vendor issues a fix. Since there is no patch available at the time of the attack, zero-day vulnerabilities pose a high-risk threat.
   
3. Misconfiguration:
   Improperly configured OS settings—such as weak permissions, unnecessary services enabled, default credentials, or open ports—create security gaps. Attackers can leverage these weaknesses to bypass controls, access sensitive data, or execute malicious actions.
   
4. Data Exfiltration:
   Certain OS-level vulnerabilities or weaknesses can allow attackers to extract sensitive data from the system. This can happen through compromised processes, malicious scripts, insecure APIs, or unauthorized applications running at the OS layer.
   
5. Malicious Updates:
   If attackers tamper with update mechanisms or trick users into installing fake OS updates, they can distribute malware disguised as legitimate patches. This leads to system compromise at a deep, trusted level, making detection and recovery more difficult.
### SQL and XML Injections
Now, an injection attack occurs when an attacker sends malicious data to a system, which is then processed as part of a command or query, which can lead to unintended consequences.

Code Injection:
The insertion of additional information or code through a data input form from a client to an application.
#### SQL Injection
SQL Injection is a web application attack where an attacker inserts malicious SQL queries into an application's input fields (like login forms or search boxes). The goal is to trick the backend database into executing unintended commands—such as revealing confidential data, modifying records, or bypassing authentication.

SQL injection happens when the application directly embeds user input into SQL queries without proper validation or sanitization.

Example:
Suppose a website has a login form. A normal query might look like this:
`SELECT * FROM users WHERE username = 'user' AND password = 'pass';`
But if the application does **not validate input**, an attacker can enter:
- **Username:** `admin`
- **Password:** `' OR '1'='1`
The resulting SQL query becomes:
`SELECT * FROM users WHERE username = 'admin' AND password = '' OR '1'='1';`
##### Concept of True Condition in SQL Injection:
The trick in SQL Injection is to force the SQL query to always return true.

`' OR '1'='1` is always true because **1 equals 1**, no matter what password is entered.

This causes the database to interpret the query as:
If the password matches → allow login OR Since `'1'='1'` is always true → allow login anyway
This means the attacker can log in as any user without knowing the password.
##### How to Prevent SQL Injection
1. User Input Validation: Ensure the application only accepts expected formats.
2. Data Sanitization: Sanitizing means cleaning user input before it reaches the SQL query.
3. Use of Web Application Firewall (WAF): A WAF monitors and filters malicious HTTP traffic before it reaches the web application.
#### XML
Used by web applications for authentication, authorization, and other types of data exchange.
Example of XML format:
```
<?xml version="1.0" encoding="UTF-8"?>
<LoginRequest>
    <Username>admin</Username>
    <Password>password</Password>
</LoginRequest>
```
##### XML Bomb (Billion Laugh Attack)
An XML Bomb is a type of Denial-of-Service (DoS) attack that uses a specially crafted XML document designed to recursively expand entities to an enormous size.
A single small XML file can expand into gigabytes of data when parsed, overwhelming system memory and causing the application or server to crash.

Example:
```
<?xml version="1.0"?>
<!DOCTYPE lolz [
  <!ENTITY lol "lol">
  <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
  <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">
  <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
]>
<root>&lol3;</root>
```
##### XML External Entity (XXE)
XXE is a vulnerability where an attacker injects or manipulates external entities in XML to access sensitive files, perform SSRF (Server-Side Request Forgery), or leak system data.

The danger comes from XML parsers that allow external entity resolution, which can be abused to read local files or make internal network calls.
Example:
```
<?xml version="1.0"?>
<!DOCTYPE data [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<user>
    <info>&xxe;</info>
</user>
```
If the server processes this, the content of /etc/passwd will be inserted into the XML output — exposing sensitive data.
### XSS and XSRF
#### Cross-Site Scripting (XSS)
Cross-Site Scripting (XSS) is a web vulnerability where an attacker injects malicious JavaScript (or other client-side code) into a trusted website. When a victim loads the page, the injected script executes in their browser, allowing the attacker to steal cookies, sessions, sensitive data, or perform unauthorized actions on the victim’s behalf.

XSS occurs when a web application fails to properly validate or escape user input before rendering it in the browser.

Types:
Reflected XSS (Non-Persistent XSS):
Reflected XSS happens when malicious input is immediately returned (reflected) by the server in the response.
It is non-persistent because the attack payload is not stored anywhere — it only works when the victim clicks a malicious link crafted by the attacker.
Example:
`https://example.com/search?q=<script>alert('Hacked')</script>`

Stored XSS (Persistent XSS):
Stored XSS is the most dangerous type.
Here, the malicious script is stored permanently on the server — in a database, message board, comment section, profile page, or logs.
Every user who views the infected page executes the attacker's script.

DOM-Based XSS:
DOM-based XSS occurs entirely on the client side.
The malicious input is processed by JavaScript in the browser, not by the server.
The vulnerability exists in the webpage’s JavaScript code itself.
The server may never see the malicious payload.
Example:
`https://example.com/index.html#default<script>alert(document.cookie)</script>`

DOM XSS runs with the logged-in user's privileges of the local system.
#### Cross-Site Request Forgery
Cross-Site Request Forgery (CSRF) is a web attack where an attacker tricks a victim into unintentionally performing actions on a trusted website where they are already authenticated.

An attacker makes the victim’s browser send a malicious request to a legitimate site **without their knowledge**, using their valid authentication.

Because the victim is already logged in, the website processes the request as if the victim intended it.

Mitigation:
- use user-specific tokens in all form submissions
- add randomness and prompt for additional information
- require users to enter their current password when changing their password
### Buffer Overflow
Buffer Overflow occurs when a program receives more data than the memory buffer is designed to hold. A buffer is a temporary storage area in memory, and when too much data is written to it, the extra data overflows into adjacent memory locations, which can be exploited by attackers.

Why it is dangerous:
Attackers can use a buffer overflow to overwrite important memory values, such as return addresses, and force the program to execute malicious code. This can lead to remote code execution, system compromise, or full control of the target machine.
Example:
A program expects a username of 8 characters, but an attacker inputs 50 characters instead. The extra characters overflow the buffer and overwrite nearby memory, allowing the attacker to inject and execute malicious code.
##### Stack Smashing
Stack smashing is a type of buffer overflow attack where an attacker overflows a buffer stored on the stack to overwrite the return address. This forces the program to execute attacker-controlled code instead of returning to legitimate code.
Example:
An attacker inputs excessive data into a vulnerable application, overwrites the return pointer, and redirects execution to malicious shell code, giving them system access.
##### ASLR (Address Space Layout Randomization)
ASLR is a security technique that randomly arranges the memory locations used by a program each time it runs. This makes it difficult for attackers to predict where important code or return addresses are stored in memory.
Example:
Even if an attacker knows how a buffer overflow works, ASLR changes memory addresses every time the system starts, so the attacker cannot reliably jump to their malicious code.

```
Buffer Overflow vs Buffer Underflow

A buffer overflow happens when a program writes more data than a buffer can hold, causing excess data to spill into adjacent memory. This can allow attackers to overwrite memory and execute malicious code.

A buffer underflow occurs when a program reads or writes data before the beginning of a buffer. This can expose sensitive memory contents or cause unintended behavior, but it is less commonly exploited than buffer overflow.
```
### Race Condition
A race condition is a software vulnerability that occurs when the outcome of a program depends on the timing or order of multiple processes or threads. If these processes do not execute in the sequence intended by the developer, an attacker may exploit the timing gap to gain unauthorized access or perform unintended actions.
Example:
A legitimate user and an attacker send requests at the same time. If the attacker’s request is processed first due to timing, they may bypass security checks.

Why Race Conditions Are Dangerous
Race conditions often occur at the memory, file system, or database level and are difficult to detect because they may not leave logs or error messages. They can result in privilege escalation, data corruption, or unauthorized access.
Example:
The Dirty COW vulnerability allowed attackers to gain write access to read-only files by exploiting a timing flaw in Linux memory management.
##### Time-of-Check (TOC)
A time-of-check vulnerability happens when a system checks the state of a resource but does not immediately act on it. If the resource changes between the check and the action, security can be bypassed.
Example:
A banking app checks if sufficient funds exist, but before the transfer executes, the attacker initiates another transaction.
##### Time-of-Use (TOU)
A time-of-use vulnerability occurs when a resource is altered after it has been checked but before it is actually used. TOC and TOU are two phases of the same race condition vulnerability.
Example:  
A file permission is checked as read-only, but the attacker modifies the file before it is accessed.
##### Time-of-Evaluation (TOE)
A time-of-evaluation vulnerability occurs when an attacker modifies data while the system is evaluating conditions or making decisions based on that data.
Example:
An attacker changes input values during a calculation, causing incorrect authorization decisions.

```
TOC/TOU vulnerability occurs when a system checks a resource and later uses it, but an attacker changes the resource between those two steps.
```
##### Mitigation: Locks and Mutex
Locks and mutexes are used to prevent race conditions by ensuring that only one process or thread can access a shared resource at a time. When a resource is locked, other processes must wait until the lock is released before they can access or modify that resource. This prevents timing issues where multiple operations try to run simultaneously.

A mutex (mutual exclusion) is a special type of lock that acts like a gatekeeper for a section of code or a resource. When one thread acquires the mutex, all other threads are blocked from entering that critical section until the mutex is released. This guarantees that operations occur in the correct order and prevents unexpected changes to shared data.
Example:
When a user opens a shared document for editing in SharePoint, the file is locked for editing. Other users can view the file but cannot modify it until the original user finishes and releases the lock. This prevents two users from changing the file at the same time and avoids data corruption caused by race conditions.

Next module [[18. Malicious Activity]]















