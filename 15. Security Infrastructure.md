Now, security infrastructure encompasses the hardware, software, networks, data, and policies that are working cohesively together to safeguard an organization's information and assets. Ensuring a robust and secure infrastructure is vital to thwart potential cyber threats, and to ensure the organization's data remains uncompromised.
### Ports and Protocols
##### Ports:  
Now, a port is simply a logical communication endpoint that exists on your computer or server.  
For example, if you're running a secure web server that's used for e-commerce on your system, you're going to have port 443 open and listening for any inbound requests from your potential visitors.
Now, ports are going to be classified as either inbound or outbound ports:
- Inbound Port:  
  Logical communication opening on a server that is listening for a connection from a client.
- Outbound Port:  
  Logical communication opening created on a client in order to call out to a server that is listening for connection.

Ports can be any number between 0 and 65553, divided into three groups:
1. Well-Known Ports:
   Ports 0 to 1023 are considered well-known and are assigned by the Internet Assigned Numbers Authority (IANA).
2. Registered Ports:
   Ports 1024 to 49,151 are considered registered and are usually assigned to proprietary protocols.
   Example:
   Microsoft has an SQL server that is using one of these registered ports. In this case it's port 1433, which is the registered port for the Microsoft SQL server. Another good example of this is if you're going to use the proprietary Microsoft protocol known as RDP or the Remote Desktop Protocol because it operates over port 3389.
3. Dynamic and Private Ports:  
   Port 49,152 to 65,535 can be used by any application without being registered with IANA.
##### Protocols:
Now, a protocol is a defined set of rules and conventions that governs the communication and data exchange between devices or systems that specifies the format and the sequence of messages, that are going to be used for those communications.
Example:
Port 443 is commonly used for secure e-commerce website traffic because it works with the HTTPS (Hypertext Transfer Protocol Secure) protocol. When a user enters their payment information on an online store, HTTPS ensures the data - such as credit card details and HTML content - is encrypted while being sent between the browser and the web server, keeping the transaction secure.

```
- Port 21 (TCP) - File Transfer Protocol (FTP) - Used to transfer files from host to host
- Port 22 (SSH, SCP and SFTP) - Provides secure remote terminal access and file transfer capabilities, Provides secure copy functions, Provides secure file transfer
- Port 23 (TCP) - Telnet - Provides insecure remote control of the another machine using a text-based environment
- Port 25 (TCP) - Simple Mail Transfer Protocol (SMTP) - Provides the ability to send emails over the network
- Port 53 (TCP and UDP) - Domain Name System (DNS) - Translate domain names into IP addresses
- Port 69 (UDP) - Trivial File Transfer Protocol (TFTP) - Used as a lightweight file transfer method for sending configuration files or network booting of an operating system
- Port 80 (TCP) - Hypertext Transfer Protocol (HTTP) - Used for insecure web browsing
- Port 88 (UDP) - Kerboros - Network authentication protocol
- Port 110 (TCP) - Post Office Protocol Version Three (POP3) - Responsible for retrieving email from a server
- Port 119 (TCP) - Network News Transfer Protocol (NNTP) - Used for accessing newsgroups
- Port 135 (TCP and UDP) - Remote Procedure Call (RPC) - Facilitates communication between different system processes
- Ports 137, 138, 139 (TCP and UDP) - NetBIOS - Networking protocol suite
- Port 143 (TCP) - Internet Message Access Protocol (IMAP) - Allows access to email messages on a server
- Port 161 (UDP) - Simple Network Management Protocol (SNMP) - Manages network devices
- Port 162 (UDP) - SNMP Trap - Responsible for sending SNMP trap message
- Port 389 (TCP) - Lightweight Directory Access Protocol (LDAP) - Facilitates directory services
- Port 443 (TCP) - HTTP Secure (HTTPS) - Provides secure web communication
- Port 445 (TCP) - Server Message Block (SMB) - Used for file and printer sharing over a network
- Port 465 and 587 (TCP) - SMTP Secure (SMTPS)- Provides secure SMTP communication
- Port 514 (UDP) - Syslog - Used for sending log messages
- Port 636 (TCP) - LDAP Secure (LDAPS) - LDAP communication over SSL/TLS
- Port 993 (TCP) - Internet Message Access Protocol over SSL/TLS (IMAPS) - Used for secure email retrieval
- Port 995 (TCP) - Post Office Protocol Version Three over SSL/TLS (POP3S) - Used for secure email retrieval
- Port 1433 (TCP) - Microsoft SQL - Used to facilitate communication with Microsoft SQL Server
- Port 1645 and 1646 (TCP) - RADIUS TCP - Used for remote authentication, Authorization, and Accounting
- Port 1812 and 1813 (UDP) - RADIUS UDP - Used for authentication and accounting as defined by Internet Engineering Task Force
- Port 3389 (TCP) - Remote Desktop Protocol (RDP) - Enables remote desktop access
- Port 6514 (UDP) - Syslog TLS - Used in a secure syslog that uses SSL/TLS to encrypt the IP packets using a certificate before sending them across the IP network to the syslog collector
```
### Firewalls
Now, a firewall is a network security device or software that monitors and controls incoming and outgoing network traffic based on predetermined security rules to protect a network from unauthorized access and potential threats.
By placing a firewall in front of a given network segment, we can create what is known as a Screened Subnet, now a Screened Subnet, also known as a Dual-homed Host configuration, plays a crucial role in network security by acting as a protective barrier between external untrusted networks, and internal trusted networks.  
Under this setup, a Dual-homed Host will often be equipped with a packet-filtering firewall or other security mechanisms by sitting between these networks.  

This effectively helps to screen and filter traffic it passes from the untrusted network to the trusted network, and it will serve as a buffer that's going to inspect and control incoming traffic so that only legitimate and authorized data flows can make it through to your internal network, and everything else will be blocked, including potential threats and unauthorized access attempts.

Now to create a screened subnet, you must first install a firewall into your network.  
There are many different types of firewalls out there, including Packet filtering, Stateful, Proxy, Dynamic packet filtering, and Kernel proxy firewalls.

1. Packet Filtering Firewall:
   A Packet Filtering Firewall inspects only the packet header and allows or denies traffic based on IP addresses, port numbers, and protocols. Because inspection is limited to headers, it cannot protect against IP spoofing, packet fragmentation, or TCP handshake attacks. These firewalls operate at Layer 4 (Transport Layer) of the OSI model and provide high performance with low security.
   Key point: Fastest firewall, least secure.
   
2. Stateful Firewall: 
   A Stateful Firewall tracks the state of active connections and remembers outbound requests made from the internal network. It allows return traffic only if it matches an existing, valid session, providing better security than packet filtering firewalls.
   Example:
   When you visit `example.com`, the firewall remembers the request and allows the response traffic back to your system.

3. Proxy Firewall:
   A Proxy Firewall sits between internal and external systems and creates connections on behalf of endpoints, hiding internal systems from direct exposure.
    - Circuit-level Proxy (Layer 5):
      Operates at the Session Layer, establishes two TCP connections (client-to-proxy and proxy-to-server), but does not deeply inspect packet contents. It is faster but provides limited security.
    - Application-level Proxy (Layer 7):
      Performs deep packet inspection at the Application Layer and understands protocols like HTTP, FTP, and SMTP. It offers higher security but increases latency.
   Key point: Application proxy = Layer 7 firewall.

4. Kernel Proxy Firewall (Fifth Generation Firewall):
   A Kernel Proxy Firewall creates connections on behalf of systems like a proxy firewall but performs full packet inspection at all OSI layers with minimal performance impact. These firewalls are typically placed close to the systems they protect for maximum efficiency.
   Key point: Deep inspection with high performance.
   
```
Next Generation Firewall (NGFW):
An NGFW improves upon stateful firewalls by being application-aware, performing deep packet inspection, and supporting signature-based intrusion prevention. NGFWs provide full-stack visibility, granular traffic control, and high performance but are complex to manage and can lead to vendor dependency.
Key point: Application-aware + IPS + DPI.

Unified Threat Management Firewall (UTM):
A UTM combines multiple security functions into a single device, including firewall, IPS, antivirus, VPN, content filtering, and sometimes DLP. While UTMs reduce cost, complexity, and power usage, they introduce a single point of failure and may perform slower than specialized devices.
Key point: All-in-one security appliance.

Web Application Firewall (WAF):
A WAF focuses specifically on HTTP and HTTPS traffic to protect web applications from attacks such as SQL injection and cross-site scripting (XSS). It can be deployed inline (to block attacks) or out-of-band (to monitor and alert only).
Key point: Protects web applications, not the entire network.

Layer 4 → Packet Filtering
Layer 5 → Circuit-level Proxy
Layer 7 → Application Proxy / WAF
NGFW → Stateful + DPI + App awareness
UTM → Multiple security tools in one box
```

Inline configuration places the firewall directly in the path of network traffic to enforce real-time security policies, while out-of-band configuration separates the management and monitoring planes from the primary data flow.
### IDS and IPS
##### IDS (Intrusion Detection System):
A monitoring system that detects and alerts on suspicious or malicious network activity but does not block it.
Example: A IDS detects unusual login attempts and sends an alert to the admin.

 - NIDS (Network Intrusion Detection System): 
   Monitors network traffic across multiple hosts for suspicious patterns like scans or exploits by analyzing packets in real-time.
 - HIDS (Host Intrusion Detection System): 
   Runs on individual endpoints to watch file changes, processes, logs, and system calls for signs of compromise.
 - WIDS (Wireless Intrusion Detection System): 
   Scans Wi-Fi airspace for rogue access points, unauthorized clients, flooding authentication requests and wireless attacks via RF analysis.

Intrusion detection systems operate either using signature-based or anomaly-based detection algorithms.
- Signature-based:
  Analyzes traffic based on defined signatures and can only recognize attacks based on previously identified attacks in its database.
  There are two types of Signature-based: 
   ⇾ Pattern-matching: specific pattern or steps (commonly used in NIDS, WIDS)
   ⇾Stateful-matching: known system baseline (HIDS)

- Anomaly-bases/Behavioral-based IDS:
  Analyzes traffic and compares it to a normal baseline of traffic to determine weather a threat is occurring
  ⇾ Statistical
  ⇾ Protocol
  ⇾ Traffic
  ⇾ Rule/Heuristic
  ⇾ Application-based
##### IPS (Intrusion Detection System):
An active security system that detects and automatically blocks malicious traffic in real time to prevent attacks.
Example: A IPS automatically blocks traffic from an IP when it detects suspicious activity.

When using an IPS, it’s important to keep false positives and false negatives to a minimum to avoid blocking legitimate traffic and missing real threats.
### Network Appliances
Dedicated hardware device with pre-installed software that is designed to provide specific networking services like security, data storage, or server functions inside a network infrastructure.

Types of Network Appliances:
1. Load Balancer:
   Crucial component in any high-availability network or system that is designed to distribute network or application traffic across multiple servers.
   Application Delivery Controller (ADC)
   An Application Delivery Controller (ADC) is an advanced version of a load balancer that not only distributes traffic across multiple servers but also optimizes application performance, enhances security, and ensures high availability.
   It performs intelligent tasks like SSL offloading, caching, compression, traffic shaping, health monitoring, and even web application protection - making applications faster, more reliable, and more secure for users.

2. Proxy Server:
   A proxy server acts as an intermediary between a client and a destination server, providing functions like content caching, request filtering, logging, and traffic management.
   A proxy can store (cache) copies of frequently accessed data, allowing faster local retrieval when another client makes the same request. It also helps secure and manage traffic by enabling features such as secure tunnels, routing, access control, hiding internal network details, and even enforcing geographical restrictions by routing or blocking traffic based on location.

3. Network Sensor:
   Designed to monitor, detect, and analyze traffic and data flow across a network in order to identify any unusual activities, potential security breaches, or performance issues.
   It provides performance monitoring, detects performance anomalies, and can trigger alerts when abnormal or suspicious behavior is observed.
   IDS or IPS are example of Network Sensors.

4. Jump Server/Box:
   A jump server (or jump box) is a hardened, centrally controlled gateway that system administrators use to securely access devices, servers, or workloads located in different security zones of a network. Instead of allowing direct access to sensitive systems, all admin connections must first go through the jump server, which acts as a controlled access point.
### Port Security
Common security feature found on network switches that allows administrators to restrict which devices can connect to specific port based on the network interface card's MAC address, by enabling port security, your organization can prevent any unauthorized devices from accessing your network.

Transparent bridging allows Ethernet switches to automatically learn and forward traffic efficiently, making the network work seamlessly without manual routing setup.

Previously, hubs broadcasted data to all ports, sending every frame to every connected device.
But switches are smarter - they learn which device is connected to which port by observing MAC addresses and storing them in a CAM (Content Addressable Memory) table.
This allows the switch to forward traffic only to the intended device, reducing unnecessary network traffic and improving efficiency.
##### CAM (Content Addressable Memory) Table
It’s a lookup table that tells the switch “which device (MAC address) is located on which port”, so the switch can send frames directly to the correct destination instead of flooding the network.
##### MAC Flooding
MAC flooding is an attack where an attacker sends a large number of fake or random MAC addresses into a switch to overflow its CAM table.
When the CAM table becomes full, the switch can no longer map MAC addresses to ports, so it fails open and starts acting like a hub - broadcasting all traffic to all ports.
This allows the attacker to capture network traffic (packet sniffing) that they normally wouldn’t have access to.

To prevent this type of attack, we should enable port security or MAC filtering on the switch ports, which are also known as interfaces.
##### Persistent (Sticky) MAC Learning:
Sticky MAC learning is a port security feature on switches that automatically learns the MAC addresses on a port and then saves them as if they were manually configured.

In other words, the switch dynamically learns the MAC address of a device connected to a port and then “sticks” (stores) it in the running configuration.
If the same device reconnects later, the switch already knows it’s allowed.

But, security features like MAC filtering can be bypassed because an attacker can change (spoof) their MAC address to match one that is already allowed on the network. Network interface cards (NICs) allow MAC address modification easily, so an attacker can reset their MAC to a “trusted” or “approved” one from your allowed list.

To prevent this, organizations use stronger, layered defenses such as the 802.1X protocol combined with Extensible Authentication Protocol (EAP). These mechanisms require proper user or device authentication—rather than just relying on MAC addresses—making it much harder for attackers to gain access even if they spoof a MAC address.
##### 802.1X Protocol:
Standardized framework that is used for port-based authentication for both wired and wireless networks, by utilizing other mechanisms such RADIUS or TACACS+.
Now, for 802.1X authentication to work, it's going to require the use of three different roles:
- Supplicant: The supplicant is the client device (laptop, phone, workstation) that wants to connect to the network.
- Authenticator: The authenticator is the network device that controls access - usually a switch (wired) or an access point (wireless).
- Authentication Service: The authentication server - typically a RADIUS or TACACS+ server - validates the supplicant’s credentials.

```
RADIUS - Cross-platform (doesn't support Remote Access Protocol, NetBIOS Frame Protocol or X.25 PAD connections)
TACACS+ - Cisco-proprietary protocol (work on TCP, and support all the protocols)
```
  
  The 802.1x framework can also be used to encapsulate Extensible Authentication Protocol (EAP) too.
##### Extensible Authentication Protocol (EAP):
Extensible Authentication Protocol or EAP is not a single protocol by itself, but instead, it is a framework in a series of protocols that allows for the numerous different way for us to conduct authentication such as simple passwords, digital certificates, and public key infrastructure.
There are lots of different variants of EAP:
- EAP-TTLS:
  EAP-TTLS uses a server-side certificate to create a secure TLS tunnel, after which the client can authenticate with passwords or other methods inside the encrypted tunnel. Since only the server needs a certificate, it is easier to deploy compared to EAP-TLS while still offering strong security. It is commonly used when certificate deployment to clients is difficult.
  
- EAP-FAST:
  EAP-FAST, developed by Cisco, provides authentication through a secure tunnel similar to PEAP but uses PACs (Protected Access Credentials) instead of certificates. It offers fast, secure authentication without requiring a full certificate infrastructure. It is often used in environments where certificate management is challenging but security needs to remain strong.
  
- EAP-TTLS:
  EAP-TTLS uses a server-side certificate to create a secure TLS tunnel, after which the client can authenticate with passwords or other methods inside the encrypted tunnel. Since only the server needs a certificate, it is easier to deploy compared to EAP-TLS while still offering strong security. It is commonly used when certificate deployment to clients is difficult.
  
- EAP-FAST:
  EAP-FAST, developed by Cisco, provides authentication through a secure tunnel similar to PEAP but uses PACs (Protected Access Credentials) instead of certificates. It offers fast, secure authentication without requiring a full certificate infrastructure. It is often used in environments where certificate management is challenging but security needs to remain strong.
  
- PEAP (Protected EAP):
  Creates an encrypted TLS tunnel using a server certificate and then authenticates the client inside that secure channel using username–password credentials, typically from Active Directory. It is widely used in enterprise Wi-Fi networks because it balances strong security with easier deployment, requiring certificates only on the server side.
  
- EAP-LEAP:
  EAP-LEAP is an older Cisco-proprietary authentication method that relies on username-password credentials but lacks strong protection. It is vulnerable to dictionary and brute-force attacks due to weak encryption. Because of these security issues, LEAP is considered outdated and has largely been replaced by more secure methods like PEAP, EAP-FAST, and EAP-TLS.
### Securing Network Communication
##### VPN (Virtual Private Network):
Extends a private network over a public one, enabling users to securely send and receive data across a shred or public network as if they're computing devices were directly connected to organization's own private network.

To use a VPN, the user must first connect to the VPN appliance located at the organization’s headquarters or data center. The VPN client and the VPN device then establish a secure, encrypted tunnel using a VPN protocol, allowing the corporate user to safely access internal resources over an untrusted or public network.
These VPNs can be configured as a site-to-site VPN, a client-to-site VPN or a clientless VPN
- Site-to-Site VPN:
  A site-to-site VPN connects two entire networks together over the internet, creating a secure tunnel between them. It is used by organizations that have multiple office locations and want them to communicate as if they were on the same internal network.
  Example:
  A company has headquarters in Mumbai and branch office in Delhi, both offices have routers/firewalls capable of VPN.
  A site-to-site VPN tunnel is created between the two office routers, so employees in Delhi can access resources in Mumbai (file servers, databases, internal apps) as if they were all in one building.
  Employees don’t need to run VPN software; the connection is automatic between the two sites.

- Client-to-Site VPN (Remote Access VPN):
  A client-to-site VPN allows individual users to securely connect to the company network from remote locations. The user installs VPN software on their laptop or mobile device, and it connects to a VPN server at the company.
  Example:
  An employee works from home in Bangalore, they open their VPN client on their laptop and connect to the VPN server at the company’s data center.
  A secure tunnel is formed, allowing them to access internal systems (email, servers, intranet) as if they were physically in the office.

- Clientless VPN:
  A clientless VPN allows users to securely access corporate resources without installing any VPN software on their device.
  Instead, the user simply logs in through a web browser, usually via HTTPS, and the VPN gateway creates a secure, encrypted session.
  This type of VPN is commonly used when users only need access to web-based applications, email portals, shared files, or internal websites.
  Example:
  A contractor or remote employee opens a browser and goes to: `https://vpn.company.com`
  They log in with their credentials, and the VPN appliance gives them secure access to internal web applications without installing a VPN client.

```
Full Tunnel and Split Tunnel Configuration:
- Full Tunnel VPN:
  In a full tunnel configuration, all of the user’s traffic (corporate traffic +
  internet traffic) is sent through the VPN tunnel to the company’s network.
  The company firewall then sends internet-bound traffic out to the internet.
  Example:
  A remote employee connects to the company VPN from home.
  They visit Google.com → The request first goes to the company’s data center →
  then to Google.

- Split Tunnel VPN:
  In a split tunnel configuration, only corporate traffic goes through the VPN
  tunnel.
  General internet traffic goes directly to the internet from the user’s device.
  Example:
  A user connects to VPN to access a file server in the office.
  But when they open YouTube, the traffic goes directly to the internet from their
  home Wi-Fi—not through the corporate VPN.
```
##### TLS (Transmission Control Protocol)
A protocol that provides cryptographic security for secure connections and is used for secure web browsing and data transfer.
Transmission Control Protocol (TCP) used by TLS to establish secure connections between a client and a server, but it may slow down the connection.

```
DTLS (Datagram Transport Layer Security):
DTLS is a security protocol designed to provide encryption, authentication, and data integrity for applications that use UDP instead of TCP.
It is essentially the UDP version of TLS.
```
##### IPSec
A protocol suite for secure communication through authentication and data encryption in IP networks.
IPSec provides several core security services, including Confidentiality, Integrity, Authentication, and Anti-Replay protection. These ensure that data is encrypted, not altered, sent by a verified source, and protected against attackers trying to resend or replay captured packets.

Steps of IPSec Tunnel Creation:
1. Request to start Internet Key Exchange (IKE):
   The process begins when one device initiates communication and requests to start an IKE negotiation. This signals that the devices want to build a secure IPSec tunnel.

2. IKE Phase 1 – Establish a Secure Channel:
   In Phase 1, both devices authenticate each other (using pre-shared keys or certificates) and create a secure, encrypted control channel called the IKE SA (Security Association).
   This channel protects further negotiations.
   
3. IKE Phase 2 – Build IPSec Tunnel Parameters:
   In Phase 2, the devices negotiate IPSec SA(s) that define:
    - Which encryption algorithms to use
    - Which hashing/integrity algorithms to use
    - What traffic should be protected
   This phase establishes the IPSec tunnel where actual data will flow.

4. Data Transfer:
   Once the IPSec tunnel is active, data can securely flow between the two endpoints.
   All packets are encrypted, authenticated, and protected from replay attacks based on the agreed IPSec parameters.

5. Tunnel Termination:
   When the session ends or the lifetime expires, IPSec SAs and keys are deleted.
   The secure tunnel closes, ensuring no further communication occurs without re-establishing a new IKE negotiation.

- IPSec Transport Mode:
  In Transport Mode, only the payload (data part) of the IP packet is encrypted, while the original IP header remains unchanged.
  This mode is typically used for client-to-site VPNs communication.

- IPSec Tunnel Mode:
  In Tunnel Mode, the entire original IP packet is encrypted, and then it is wrapped inside a new IP packet with a new IP header.
  Tunnel Mode is used for site-to-site VPNs.

- Authentication Header (AH):
  The Authentication Header (AH) is an IPSec protocol that provides data integrity, authentication, and anti-replay protection for IP packets. It ensures that the data has not been modified during transit and verifies the identity of the sender. AH also protects parts of the IP header, making it useful when detecting any unauthorized changes to the packet structure is important. However, AH does not offer encryption, meaning the payload remains visible. Because of this, AH is mainly used when confidentiality is not required but integrity and authenticity are essential.
- Encapsulating Security Payload (ESP):
  Encapsulating Security Payload (ESP) is an IPSec protocol that delivers confidentiality through encryption, along with optional integrity, authentication, and anti-replay protection. Unlike AH, ESP encrypts the actual payload, ensuring that the data remains hidden from unauthorized users. ESP does not protect the outer IP header in transport mode, but in tunnel mode, it can secure the entire original packet. ESP is widely used because it provides both encryption and integrity, making it the preferred choice for securing VPNs and sensitive communications.
  
  ⇾ In transport mode, use the authentication header for TCP header integrity, then add ESP to encrypt TCP header and payload
  ⇾ In tunneling mode, employ both the authentication header and the encapsulated security payload
### SD-WAN and SASE
##### SD-WAN (Software-Defined Wide Area Network)
SD-WAN virtualizes WAN management by decoupling control from hardware, using software to intelligently route traffic across MPLS, broadband, LTE, or other links based on application needs, performance, and cost.

SD-WAN Architecture and Benefits
Centralized controllers orchestrate policies across edge devices at branches, enabling dynamic path selection (e.g., switching VoIP to LTE if MPLS lags) and features like compression or zero-touch provisioning. A retail chain example: HQ connects 200 stores via mixed broadband/MPLS; SD-WAN prioritizes POS transactions over email, cuts MPLS costs by 50%, and maintains uptime during outages.
##### SASE (Secure Access Service Edge)
SASE converges networking (SD-WAN) with cloud-delivered security (FWaaS, ZTNA, SWG, CASB) into a unified service, accessed via identity from any edge location or device.
SASE Architecture and Example
Traffic routes to nearest PoP for inspection/optimization rather than backhauling to data centers, reducing latency while enforcing consistent policy. Example: A global firm with remote workers uses SASE so a Mumbai employee accesses SaaS apps securely via the nearest Cloudflare PoP - SD-WAN handles routing, ZTNA verifies identity, SWG blocks malware - without VPNs or branch appliances.
### Infrastructure Considerations
##### Correct Placement of Devices
Correct placement of network devices refers to positioning routers, switches, firewalls, and access points in locations that optimize both network performance and security. Proper placement ensures smooth data flow, reduces latency, and helps enforce security controls effectively. Devices placed incorrectly can create bottlenecks, blind spots, or security gaps that attackers may exploit.
Example:
A firewall is placed at the edge of the network between the internet and the internal network so it can inspect all incoming and outgoing traffic before it reaches internal systems.
##### Security Zones and Screened Subnets
Security zones are logically separated sections of a network that group systems with similar security requirements and trust levels. Screened subnets (formerly called DMZs) act as a buffer zone between an internal network and untrusted networks like the internet. These zones limit how far an attacker can move if a system is compromised.
Example:
A company hosts its public web server in a screened subnet, while employee systems and databases remain in an internal security zone protected by strict firewall rules.
##### Understanding Attack Surface
The attack surface represents all possible entry points an attacker could use to access or exploit a system or network. This includes exposed services, open ports, internet-facing devices, misconfigurations, and weak authentication methods. A larger attack surface increases risk, so organizations aim to minimize it through proper configuration and security controls.
Example:
Disabling unused services and closing unnecessary ports on a server reduces the number of ways an attacker can attempt to compromise it.
##### Determining Connectivity Methods
Connectivity methods define how systems communicate within a network and with external networks. These methods include wired connections, wireless networks, fiber optics, and hybrid approaches. Each method impacts speed, reliability, scalability, and security, so organizations must choose based on their operational needs.
Example:
An office uses wired Ethernet for desktops to ensure stable and fast connections, while Wi-Fi is used for laptops and mobile devices to provide flexibility.
##### Understanding Device Attributes
Device attributes describe how a network or security device operates, such as whether it is active or passive and whether it is installed inline or as a monitoring tap. Active, inline devices can block or modify traffic, while passive devices only observe and report activity. Choosing the right attribute depends on security and performance requirements.
Example:
An intrusion prevention system (IPS) is deployed inline to block malicious traffic in real time, while an intrusion detection system (IDS) is deployed passively to monitor traffic without affecting performance.
##### Configuring the Failure Mode
Failure modes determine how a device behaves when it fails or becomes overloaded. In fail-open mode, traffic is allowed to pass without inspection to maintain availability, while fail-closed mode blocks all traffic to preserve security. The choice depends on how critical security or availability is for that network segment.
Example:
A firewall protecting a financial database is configured to fail-closed so that if it fails, all traffic is blocked to prevent unauthorized access.
### Selecting Infrastructure Controls
Selecting infrastructure controls means choosing safeguards that protect an organization’s network, systems, and data from risks and vulnerabilities. Every time new hardware or software is added, it introduces potential weaknesses, so controls are selected to reduce those risks while using resources efficiently. As a cybersecurity professional, the goal is to prevent breaches, minimize impact, and maintain trust by applying the right controls in the right way. Control selection is not a one-time activity; it must be reviewed and adjusted as threats and business needs change.
Example:
Installing a firewall and access control policies when a new application server is added to the network.
##### Key Principles for Selecting Effective Controls
- Principle of Least Privilege
  Users and systems should be given only the minimum access required to perform their tasks. This reduces the attack surface and limits damage if an account is compromised.
  Example: A SOC analyst has read-only access to logs but no admin rights.
- Defense in Depth:
  Defense in depth uses multiple layers of security so that if one control fails, others still protect the system. It avoids reliance on a single security mechanism.
  Example: Firewall, endpoint protection, and SIEM working together.
- Risk-Based Approach:
  Controls are prioritized based on the likelihood and impact of risks. This ensures limited resources are focused on the most critical threats and assets.
  Example: Strong controls are applied to customer data systems first.
- Lifecycle Management:
  Security controls must be regularly reviewed, updated, and retired as threats and technologies evolve. Controls are not a one-time implementation.
  Example: Upgrading outdated security tools to newer solutions.
- Open Design Principle:
  Security should rely on well-tested and transparent designs rather than secrecy. Controls should be openly reviewed and validated for effectiveness.
  Example: Using standard, proven encryption methods instead of custom ones.
##### Methodology for Selecting Controls
- Assess the Current State:
  Begin by understanding the existing infrastructure, current controls, and known vulnerabilities. This establishes a baseline before introducing new controls.
  Example: Reviewing current firewall rules and logging setup.
- Conduct Gap Analysis:
  Identify the differences between the current security posture and the desired security posture. This helps determine what controls are missing or weak.
  Example: Finding lack of monitoring for cloud workloads.
- Set Clear Objectives:
  Define what you want to achieve with new controls, such as data protection, availability, or compliance. Clear objectives guide proper control selection.
  Example: Improving incident detection and response time.
- Benchmarking:
  Compare your security posture with industry standards and best practices. This helps measure effectiveness and identify improvement areas.
  Example: Comparing controls against NIST recommendations.
- Cost-Benefit Analysis:
  Evaluate whether the security benefits of a control justify its cost and resource usage. The goal is effective security without unnecessary expense.
  Example: Choosing a SIEM solution that fits both security needs and budget.
- Stakeholder Involvement:
  Engage relevant teams to ensure controls align with business operations and are adopted effectively. This improves implementation success.
  Example: Involving IT and SOC teams before deploying new controls.
- Monitoring and Feedback Loops:
  Continuously monitor control performance and make adjustments as threats evolve. This ensures long-term effectiveness of controls.
  Example: Tuning SIEM alerts based on incident feedback.
##### Best Practices for Control Selection
Best practices start with conducting regular risk assessments to understand threats specific to the organization. Control selection should align with established frameworks like NIST or ISO, which provide proven guidance. These frameworks should be customized to match the organization’s infrastructure and risk profile. Stakeholder engagement and regular training are critical, as controls are only effective if people understand and use them correctly. Ongoing awareness and training help ensure controls support both security and business goals.

Next module [[16. Identity and Access Management (IAM) Solutions]]